# Death Adder's shockwave
name shockwave
type enemy
subtype arrow
remove  0
nodieblink 1
shadow 0
candamage enemy player npc

palette data/map.gif

anim spawn
    
    offset 0 0
    delay   1
    frame   data/chars/misc/blank.png
    move    26
    frame   data/chars/misc/blank.png

anim idle
    subentity smoke
    spawnframe 1 0 -1
    followanim 1
    followcond 1
    loop 1
    delay 3
    forcedirection -1
    hitflash none
    offset 22 24
    attack    5 11 32 20 32 1 0 1
@script
if(frame%2)
{
    void self = getlocalvar("self");
    void target = findtarget(self);
    if(target != NULL())
    {
        int z1 = getentityproperty(self, "z");
        int z2 = getentityproperty(target, "z");
        int dir = getentityproperty(self, "direction");
        int dz = 0;
        int dx = 2;
        if(z1 > z2 + 6) {dz = -0.5;}
        else if(z1 < z2 - 6){dz = 0.5;}
        if(dir){dx=-2;}
        dx += rand()%5/2.5;
        dz += rand()%5/30.0;
        changeentityproperty(self, "velocity", dx, dz, 0);
    }
}
@end_script
    sound data/sounds/shockwav.wav
    frame data/chars/misc/shockwav/1
    frame data/chars/misc/shockwav/1
    frame data/chars/misc/shockwav/2
    frame data/chars/misc/shockwav/2
    attack    5 11 32 20 32 1 1 1
    frame data/chars/misc/shockwav/3
    frame data/chars/misc/shockwav/3
    frame data/chars/misc/shockwav/1
    frame data/chars/misc/shockwav/1
    attack    5 11 32 20 32 1 0 1
    frame data/chars/misc/shockwav/2
    frame data/chars/misc/shockwav/2
    frame data/chars/misc/shockwav/3
    frame data/chars/misc/shockwav/3

anim follow1
    
    delay 8
    offset 64 112
@cmd changeentityproperty getlocalvar("self") "velocity" 0 0 0
@cmd changeentityproperty getlocalvar("self") "noaicontrol" 1
    
    frame data/chars/misc/explarge/1.gif
    frame data/chars/misc/explarge/2.gif
    frame data/chars/misc/explarge/3.gif
    frame data/chars/misc/explarge/4.gif
    frame data/chars/misc/explarge/5.gif
@cmd killentity getlocalvar("self")
    frame   data/chars/misc/blank.png


anim fall
    
    delay 8
    offset 64 112
@cmd changeentityproperty getlocalvar("self") "velocity" 0 0 0
@cmd changeentityproperty getlocalvar("self") "noaicontrol" 1
    
    frame data/chars/misc/explarge/1.gif
    frame data/chars/misc/explarge/2.gif
    frame data/chars/misc/explarge/3.gif
    frame data/chars/misc/explarge/4.gif
    frame data/chars/misc/explarge/5.gif
@cmd killentity getlocalvar("self")
    frame   data/chars/misc/blank.png
